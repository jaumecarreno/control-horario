<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Blueteam</title>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  </head>
  <body class="{{ 'layout-auth has-mobile-nav' if current_user.is_authenticated else 'layout-guest' }}">
    <header>
      <div>
        <a class="brand-link" href="{{ url_for('employee.me_today') if current_user.is_authenticated else url_for('auth.login') }}">Blueteam</a>
      </div>
      {% if current_user.is_authenticated %}
        <button type="button" class="nav-toggle-btn" id="nav-toggle-btn" aria-label="Abrir menu" aria-controls="site-nav" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>
      {% endif %}
      <nav id="site-nav">
        {% set endpoint = request.endpoint or '' %}
        {% if current_user.is_authenticated %}
          <a class="nav-link{{ ' is-active' if endpoint == 'employee.me_today' else '' }}" href="{{ url_for('employee.me_today') }}">
            <span class="nav-link-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4.8 10.3L12 4.8L19.2 10.3V18.2C19.2 19.1 18.5 19.8 17.6 19.8H6.4C5.5 19.8 4.8 19.1 4.8 18.2V10.3Z" stroke="currentColor" stroke-width="1.9" stroke-linejoin="round"/>
                <path d="M9.6 19.8V13.8H14.4V19.8" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"/>
              </svg>
            </span>
            <span class="nav-link-label">Mis horas</span>
          </a>
          <a class="nav-link{{ ' is-active' if endpoint.startswith('employee.') and endpoint != 'employee.me_today' else '' }}" href="{{ url_for('employee.presence_control') }}">
            <span class="nav-link-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4.8 12A7.2 7.2 0 1 0 12 4.8" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"/>
                <path d="M12 1.8V4.8H9" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 8.4V12.2L14.8 13.8" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="nav-link-label">Historial</span>
          </a>
          <a class="nav-link{{ ' is-active' if endpoint.startswith('admin.') else '' }}" href="{{ url_for('admin.employees_list') }}">
            <span class="nav-link-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 3.4V12L17.7 15.3" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="12" r="8.6" stroke="currentColor" stroke-width="1.9"/>
              </svg>
            </span>
            <span class="nav-link-label">Admin</span>
          </a>
          <form method="post" action="{{ url_for('auth.logout') }}" class="inline nav-logout-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button class="secondary nav-logout-btn" type="submit">
              <span class="nav-link-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M10.2 6.4H6.8C5.9 6.4 5.2 7.1 5.2 8V16C5.2 16.9 5.9 17.6 6.8 17.6H10.2" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"/>
                  <path d="M13.2 8.5L17.2 12L13.2 15.5" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M17.2 12H9.1" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"/>
                </svg>
              </span>
              <span class="nav-link-label">Cerrar sesion</span>
            </button>
          </form>
          <div class="nav-user-card" aria-label="Perfil de usuario">
            <span class="nav-user-avatar">{{ nav_profile_initials }}</span>
            <div class="nav-user-meta">
              <div class="nav-user-name">{{ nav_profile_name }}</div>
              <div class="nav-user-role">{{ nav_profile_role }}</div>
            </div>
          </div>
        {% else %}
          <a class="nav-link{{ ' is-active' if endpoint == 'auth.login' else '' }}" href="{{ url_for('auth.login') }}">Login</a>
        {% endif %}
      </nav>
    </header>
    {% if current_user.is_authenticated %}
      <button type="button" class="mobile-nav-overlay" id="mobile-nav-overlay" aria-label="Cerrar menu"></button>
    {% endif %}
    <main>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
          <div class="flash {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endwith %}
      {% block content %}{% endblock %}
    </main>
    {% if current_user.is_authenticated %}
      <script src="{{ url_for('static', filename='js/mobile-nav.js') }}"></script>
    {% endif %}
  </body>
</html>

