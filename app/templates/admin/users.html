{% extends "base.html" %}

{% block content %}
  <section class="card">
    {% include "admin/_sections.html" %}
    <h1>Users</h1>
    {% if filter_label %}
      <p class="muted">Filtro activo: <strong>{{ filter_label }}</strong> · <a href="{{ url_for('admin.users_list') }}">Limpiar</a></p>
    {% endif %}
    <p><a href="{{ url_for('admin.users_new') }}">Create user</a></p>
    <table>
      <thead>
        <tr>
          <th>Email</th>
          <th>Role</th>
          <th>Employee</th>
          <th>Active</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for membership, user, employee in rows %}
          <tr>
            <td>{{ user.email }}</td>
            <td>{{ membership.role.value if membership.role else '-' }}</td>
            <td>{{ employee.name if employee else '-' }}</td>
            <td>{{ 'Yes' if user.is_active else 'No' }}</td>
            <td>
              <a href="{{ url_for('admin.users_edit', user_id=user.id) }}">Edit</a>
              ·
              <a href="{{ url_for('admin.users_reset_password', user_id=user.id) }}">Reset password</a>
            </td>
          </tr>
        {% else %}
          <tr><td colspan="5">No users found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
{% endblock %}
