{% extends "base.html" %}

{% block content %}
  <section class="card">
    <h1>Leave requests</h1>
    <p class="muted">{{ employee.name }}</p>
    {% if active_shift %}
      <p class="muted" style="margin-top:-.35rem;">Turno activo: {{ active_shift.name }}</p>
    {% else %}
      <p class="muted" style="margin-top:-.35rem;">Sin turno activo.</p>
    {% endif %}
    <form method="post">
      {{ form.hidden_tag() }}
      <label for="{{ form.type_id.id }}">{{ form.type_id.label.text }}</label>
      {{ form.type_id() }}
      <label for="{{ form.date_from.id }}">From</label>
      {{ form.date_from() }}
      <label for="{{ form.date_to.id }}">To</label>
      {{ form.date_to() }}
      <label for="{{ form.minutes.id }}">Minutes</label>
      {{ form.minutes() }}
      {% if available_policies %}
        <div style="margin-top: 1rem;">{{ form.submit() }}</div>
      {% else %}
        <p class="muted" style="margin-top:.75rem;">No hay vacaciones o permisos configurados para tu turno actual.</p>
        <div style="margin-top: 1rem;">{{ form.submit(disabled=true) }}</div>
      {% endif %}
    </form>
  </section>

  <section class="card">
    <h2>History</h2>
    <table>
      <thead>
        <tr>
          <th>Created</th>
          <th>Type</th>
          <th>From</th>
          <th>To</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for leave_request, leave_type in rows %}
          <tr>
            <td>{{ leave_request.created_at }}</td>
            <td>{{ leave_type.code }}</td>
            <td>{{ leave_request.date_from }}</td>
            <td>{{ leave_request.date_to }}</td>
            <td>{{ leave_request.status.value }}</td>
          </tr>
        {% else %}
          <tr><td colspan="5">No requests yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
{% endblock %}
